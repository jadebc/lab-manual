<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Data Publication | Benjamin-Chung Lab Manual</title>
  <meta name="description" content="Lab practices and data science best practices" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Data Publication | Benjamin-Chung Lab Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lab practices and data science best practices" />
  <meta name="github-repo" content="jadebc/lab-manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Data Publication | Benjamin-Chung Lab Manual" />
  
  <meta name="twitter:description" content="Lab practices and data science best practices" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="code-publication.html"/>
<link rel="next" href="slurm.html"/>
<script src="libs/header-attrs-2.21/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Lab manual</a></li>

<li class="divider"></li>
<li><a href="index.html#welcome-to-the-benjamin-chung-lab" id="toc-welcome-to-the-benjamin-chung-lab"><span class="toc-section-number">1</span> Welcome to the Benjamin-Chung Lab!</a>
<ul>
<li><a href="index.html#about-the-lab" id="toc-about-the-lab"><span class="toc-section-number">1.1</span> About the lab</a></li>
<li><a href="index.html#about-this-lab-manual" id="toc-about-this-lab-manual"><span class="toc-section-number">1.2</span> About this lab manual</a></li>
</ul></li>
<li><a href="culture-and-conduct.html#culture-and-conduct" id="toc-culture-and-conduct"><span class="toc-section-number">2</span> Culture and conduct</a>
<ul>
<li><a href="culture-and-conduct.html#lab-culture" id="toc-lab-culture"><span class="toc-section-number">2.1</span> Lab culture</a></li>
<li><a href="culture-and-conduct.html#diversity-equity-and-inclusion" id="toc-diversity-equity-and-inclusion"><span class="toc-section-number">2.2</span> Diversity, equity, and inclusion</a></li>
<li><a href="culture-and-conduct.html#protecting-human-subjects" id="toc-protecting-human-subjects"><span class="toc-section-number">2.3</span> Protecting human subjects</a></li>
<li><a href="culture-and-conduct.html#authorship" id="toc-authorship"><span class="toc-section-number">2.4</span> Authorship</a></li>
</ul></li>
<li><a href="communication-and-coordination.html#communication-and-coordination" id="toc-communication-and-coordination"><span class="toc-section-number">3</span> Communication and coordination</a>
<ul>
<li><a href="communication-and-coordination.html#slack" id="toc-slack"><span class="toc-section-number">3.1</span> Slack</a></li>
<li><a href="communication-and-coordination.html#email" id="toc-email"><span class="toc-section-number">3.2</span> Email</a></li>
<li><a href="communication-and-coordination.html#trello" id="toc-trello"><span class="toc-section-number">3.3</span> Trello</a></li>
<li><a href="communication-and-coordination.html#google-drive" id="toc-google-drive"><span class="toc-section-number">3.4</span> Google Drive</a></li>
<li><a href="communication-and-coordination.html#stanford-medicine-box" id="toc-stanford-medicine-box"><span class="toc-section-number">3.5</span> Stanford Medicine Box</a></li>
<li><a href="communication-and-coordination.html#meetings" id="toc-meetings"><span class="toc-section-number">3.6</span> Meetings</a></li>
</ul></li>
<li><a href="reproducibility.html#reproducibility" id="toc-reproducibility"><span class="toc-section-number">4</span> Reproducibility</a>
<ul>
<li><a href="reproducibility.html#what-is-the-reproducibility-crisis" id="toc-what-is-the-reproducibility-crisis"><span class="toc-section-number">4.1</span> What is the reproducibility crisis?</a></li>
<li><a href="reproducibility.html#study-design" id="toc-study-design"><span class="toc-section-number">4.2</span> Study design</a></li>
<li><a href="reproducibility.html#register-study-protocols" id="toc-register-study-protocols"><span class="toc-section-number">4.3</span> Register study protocols</a></li>
<li><a href="reproducibility.html#write-and-register-pre-analysis-plans" id="toc-write-and-register-pre-analysis-plans"><span class="toc-section-number">4.4</span> Write and register pre-analysis plans</a></li>
<li><a href="reproducibility.html#create-reproducible-workflows" id="toc-create-reproducible-workflows"><span class="toc-section-number">4.5</span> Create reproducible workflows</a></li>
<li><a href="reproducibility.html#process-and-analyze-data-with-internal-replication-and-masking" id="toc-process-and-analyze-data-with-internal-replication-and-masking"><span class="toc-section-number">4.6</span> Process and analyze data with internal replication and masking</a></li>
<li><a href="reproducibility.html#use-reporting-checklists-with-manuscripts" id="toc-use-reporting-checklists-with-manuscripts"><span class="toc-section-number">4.7</span> Use reporting checklists with manuscripts</a></li>
<li><a href="reproducibility.html#publish-preprints" id="toc-publish-preprints"><span class="toc-section-number">4.8</span> Publish preprints</a></li>
<li><a href="reproducibility.html#publish-data-when-possible-and-replication-scripts" id="toc-publish-data-when-possible-and-replication-scripts"><span class="toc-section-number">4.9</span> Publish data (when possible) and replication scripts</a></li>
</ul></li>
<li><a href="code-repositories.html#code-repositories" id="toc-code-repositories"><span class="toc-section-number">5</span> Code repositories</a>
<ul>
<li><a href="code-repositories.html#project-structure" id="toc-project-structure"><span class="toc-section-number">5.1</span> Project Structure</a></li>
<li><a href="code-repositories.html#rproj-files" id="toc-rproj-files"><span class="toc-section-number">5.2</span> <code>.Rproj</code> files</a></li>
<li><a href="code-repositories.html#configuration-config-file" id="toc-configuration-config-file"><span class="toc-section-number">5.3</span> Configuration (‘config’) File</a></li>
<li><a href="code-repositories.html#order-files-and-directories" id="toc-order-files-and-directories"><span class="toc-section-number">5.4</span> Order Files and Directories</a></li>
<li><a href="code-repositories.html#using-bash-scripts-to-ensure-reproducibility" id="toc-using-bash-scripts-to-ensure-reproducibility"><span class="toc-section-number">5.5</span> Using Bash scripts to ensure reproducibility</a></li>
</ul></li>
<li><a href="coding-practices.html#coding-practices" id="toc-coding-practices"><span class="toc-section-number">6</span> Coding practices</a>
<ul>
<li><a href="coding-practices.html#organizing-scripts" id="toc-organizing-scripts"><span class="toc-section-number">6.1</span> Organizing scripts</a></li>
<li><a href="coding-practices.html#documenting-your-code" id="toc-documenting-your-code"><span class="toc-section-number">6.2</span> Documenting your code</a>
<ul>
<li><a href="coding-practices.html#file-headers" id="toc-file-headers"><span class="toc-section-number">6.2.1</span> File headers</a></li>
<li><a href="coding-practices.html#sections-and-subsections" id="toc-sections-and-subsections"><span class="toc-section-number">6.2.2</span> Sections and subsections</a></li>
<li><a href="coding-practices.html#code-folding" id="toc-code-folding"><span class="toc-section-number">6.2.3</span> Code folding</a></li>
<li><a href="coding-practices.html#comments-in-the-body-of-your-script" id="toc-comments-in-the-body-of-your-script"><span class="toc-section-number">6.2.4</span> Comments in the body of your script</a></li>
<li><a href="coding-practices.html#function-documentation" id="toc-function-documentation"><span class="toc-section-number">6.2.5</span> Function documentation</a></li>
</ul></li>
<li><a href="coding-practices.html#object-naming" id="toc-object-naming"><span class="toc-section-number">6.3</span> Object naming</a></li>
<li><a href="coding-practices.html#function-calls" id="toc-function-calls"><span class="toc-section-number">6.4</span> Function calls</a></li>
<li><a href="coding-practices.html#the-here-package" id="toc-the-here-package"><span class="toc-section-number">6.5</span> The here package</a></li>
<li><a href="coding-practices.html#readingsaving-data" id="toc-readingsaving-data"><span class="toc-section-number">6.6</span> Reading/Saving Data</a>
<ul>
<li><a href="coding-practices.html#rds-vs-.rdata-files" id="toc-rds-vs-.rdata-files"><span class="toc-section-number">6.6.1</span> <code>.RDS</code> vs <code>.RData</code> Files</a></li>
<li><a href="coding-practices.html#csvs" id="toc-csvs"><span class="toc-section-number">6.6.2</span> CSVs</a></li>
</ul></li>
<li><a href="coding-practices.html#integrating-box-and-dropbox" id="toc-integrating-box-and-dropbox"><span class="toc-section-number">6.7</span> Integrating Box and Dropbox</a>
<ul>
<li><a href="coding-practices.html#box" id="toc-box"><span class="toc-section-number">6.7.1</span> Box</a></li>
<li><a href="coding-practices.html#dropbox" id="toc-dropbox"><span class="toc-section-number">6.7.2</span> Dropbox</a></li>
</ul></li>
<li><a href="coding-practices.html#tidyverse" id="toc-tidyverse"><span class="toc-section-number">6.8</span> Tidyverse</a></li>
<li><a href="coding-practices.html#coding-with-r-and-python" id="toc-coding-with-r-and-python"><span class="toc-section-number">6.9</span> Coding with R and Python</a></li>
<li><a href="coding-practices.html#repeating-analyses-with-different-variations" id="toc-repeating-analyses-with-different-variations"><span class="toc-section-number">6.10</span> Repeating analyses with different variations</a>
<ul>
<li><a href="coding-practices.html#lapply-and-sapply" id="toc-lapply-and-sapply"><span class="toc-section-number">6.10.1</span> <code>lapply()</code> and <code>sapply()</code></a></li>
<li><a href="coding-practices.html#mapply-and-pmap" id="toc-mapply-and-pmap"><span class="toc-section-number">6.10.2</span> <code>mapply()</code> and <code>pmap()</code></a></li>
<li><a href="coding-practices.html#parallel-processing-with-parallel-and-future-packages" id="toc-parallel-processing-with-parallel-and-future-packages"><span class="toc-section-number">6.10.3</span> Parallel processing with <code>parallel</code> and <code>future</code> packages</a></li>
</ul></li>
<li><a href="coding-practices.html#reviewing-code" id="toc-reviewing-code"><span class="toc-section-number">6.11</span> Reviewing Code</a>
<ul>
<li><a href="coding-practices.html#creating-a-pull-request-template" id="toc-creating-a-pull-request-template"><span class="toc-section-number">6.11.1</span> Creating a Pull Request Template</a></li>
</ul></li>
</ul></li>
<li><a href="coding-style.html#coding-style" id="toc-coding-style"><span class="toc-section-number">7</span> Coding style</a>
<ul>
<li><a href="coding-style.html#comments" id="toc-comments"><span class="toc-section-number">7.1</span> Comments</a></li>
<li><a href="coding-style.html#line-breaks" id="toc-line-breaks"><span class="toc-section-number">7.2</span> Line breaks</a></li>
<li><a href="coding-style.html#automated-tools-for-style-and-project-workflow" id="toc-automated-tools-for-style-and-project-workflow"><span class="toc-section-number">7.3</span> Automated Tools for Style and Project Workflow</a>
<ul>
<li><a href="coding-style.html#styling" id="toc-styling"><span class="toc-section-number">7.3.1</span> Styling</a></li>
</ul></li>
</ul></li>
<li><a href="working-with-big-data.html#working-with-big-data" id="toc-working-with-big-data"><span class="toc-section-number">8</span> Working with Big Data</a>
<ul>
<li><a href="working-with-big-data.html#the-data.table-package" id="toc-the-data.table-package"><span class="toc-section-number">8.1</span> The data.table package</a></li>
<li><a href="working-with-big-data.html#using-downsampled-data" id="toc-using-downsampled-data"><span class="toc-section-number">8.2</span> Using downsampled data</a></li>
<li><a href="working-with-big-data.html#optimal-rstudio-set-up" id="toc-optimal-rstudio-set-up"><span class="toc-section-number">8.3</span> Optimal RStudio set up</a></li>
</ul></li>
<li><a href="data-masking.html#data-masking" id="toc-data-masking"><span class="toc-section-number">9</span> Data masking</a>
<ul>
<li><a href="data-masking.html#general-overview" id="toc-general-overview"><span class="toc-section-number">9.1</span> General Overview</a>
<ul>
<li><a href="data-masking.html#what-is-data-masking" id="toc-what-is-data-masking"><span class="toc-section-number">9.1.1</span> What is Data Masking?</a></li>
<li><a href="data-masking.html#using-tidy-evaluation-for-data-masking" id="toc-using-tidy-evaluation-for-data-masking"><span class="toc-section-number">9.1.2</span> Using tidy evaluation for data masking</a></li>
</ul></li>
<li><a href="data-masking.html#technical-overview" id="toc-technical-overview"><span class="toc-section-number">9.2</span> Technical Overview</a>
<ul>
<li><a href="data-masking.html#example" id="toc-example"><span class="toc-section-number">9.2.1</span> Example</a></li>
</ul></li>
</ul></li>
<li><a href="github.html#github" id="toc-github"><span class="toc-section-number">10</span> Github</a>
<ul>
<li><a href="github.html#basics" id="toc-basics"><span class="toc-section-number">10.1</span> Basics</a></li>
<li><a href="github.html#github-desktop" id="toc-github-desktop"><span class="toc-section-number">10.2</span> Github Desktop</a></li>
<li><a href="github.html#git-branching" id="toc-git-branching"><span class="toc-section-number">10.3</span> Git Branching</a></li>
<li><a href="github.html#example-workflow" id="toc-example-workflow"><span class="toc-section-number">10.4</span> Example Workflow</a></li>
<li><a href="github.html#commonly-used-git-commands" id="toc-commonly-used-git-commands"><span class="toc-section-number">10.5</span> Commonly Used Git Commands</a></li>
<li><a href="github.html#how-often-should-i-commit" id="toc-how-often-should-i-commit"><span class="toc-section-number">10.6</span> How often should I commit?</a></li>
<li><a href="github.html#what-should-be-pushed-to-github" id="toc-what-should-be-pushed-to-github"><span class="toc-section-number">10.7</span> What should be pushed to Github?</a></li>
</ul></li>
<li><a href="unix.html#unix" id="toc-unix"><span class="toc-section-number">11</span> Unix commands</a>
<ul>
<li><a href="unix.html#basics-1" id="toc-basics-1"><span class="toc-section-number">11.1</span> Basics</a></li>
<li><a href="unix.html#syntax-for-both-macwindows" id="toc-syntax-for-both-macwindows"><span class="toc-section-number">11.2</span> Syntax for both Mac/Windows</a></li>
<li><a href="unix.html#running-bash-scripts" id="toc-running-bash-scripts"><span class="toc-section-number">11.3</span> Running Bash Scripts</a></li>
<li><a href="unix.html#running-rscripts-in-windows" id="toc-running-rscripts-in-windows"><span class="toc-section-number">11.4</span> Running Rscripts in Windows</a>
<ul>
<li><a href="unix.html#common-mistakes" id="toc-common-mistakes"><span class="toc-section-number">11.4.1</span> Common Mistakes</a></li>
</ul></li>
<li><a href="unix.html#checking-tasks-and-killing-jobs" id="toc-checking-tasks-and-killing-jobs"><span class="toc-section-number">11.5</span> Checking tasks and killing jobs</a></li>
<li><a href="unix.html#running-big-jobs" id="toc-running-big-jobs"><span class="toc-section-number">11.6</span> Running big jobs</a>
<ul>
<li><a href="unix.html#example-code-for-runfilesavelogs" id="toc-example-code-for-runfilesavelogs"><span class="toc-section-number">11.6.1</span> Example code for <code>runfileSaveLogs</code></a></li>
<li><a href="unix.html#example-usage-for-runfilesavelogs" id="toc-example-usage-for-runfilesavelogs"><span class="toc-section-number">11.6.2</span> Example usage for <code>runfileSaveLogs</code></a></li>
</ul></li>
</ul></li>
<li><a href="reproducible-environments.html#reproducible-environments" id="toc-reproducible-environments"><span class="toc-section-number">12</span> Reproducible Environments</a>
<ul>
<li><a href="reproducible-environments.html#package-version-control-with-renv" id="toc-package-version-control-with-renv"><span class="toc-section-number">12.1</span> Package Version Control with renv</a>
<ul>
<li><a href="reproducible-environments.html#introduction" id="toc-introduction"><span class="toc-section-number">12.1.1</span> Introduction</a></li>
<li><a href="reproducible-environments.html#implementing-renv-in-projects" id="toc-implementing-renv-in-projects"><span class="toc-section-number">12.1.2</span> Implementing renv in projects</a></li>
<li><a href="reproducible-environments.html#using-projects-with-renv" id="toc-using-projects-with-renv"><span class="toc-section-number">12.1.3</span> Using projects with renv</a></li>
</ul></li>
</ul></li>
<li><a href="code-publication.html#code-publication" id="toc-code-publication"><span class="toc-section-number">13</span> Code Publication</a>
<ul>
<li><a href="code-publication.html#checklist-overview" id="toc-checklist-overview"><span class="toc-section-number">13.1</span> Checklist overview</a></li>
<li><a href="code-publication.html#fill-out-file-headers" id="toc-fill-out-file-headers"><span class="toc-section-number">13.2</span> Fill out file headers</a></li>
<li><a href="code-publication.html#clean-up-comments" id="toc-clean-up-comments"><span class="toc-section-number">13.3</span> Clean up comments</a></li>
<li><a href="code-publication.html#document-functions" id="toc-document-functions"><span class="toc-section-number">13.4</span> Document functions</a></li>
<li><a href="code-publication.html#remove-deprecated-filepaths" id="toc-remove-deprecated-filepaths"><span class="toc-section-number">13.5</span> Remove deprecated filepaths</a></li>
<li><a href="code-publication.html#ensure-project-runs-via-bash" id="toc-ensure-project-runs-via-bash"><span class="toc-section-number">13.6</span> Ensure project runs via bash</a></li>
<li><a href="code-publication.html#complete-the-readme" id="toc-complete-the-readme"><span class="toc-section-number">13.7</span> Complete the README</a></li>
<li><a href="code-publication.html#clean-up-feature-branches" id="toc-clean-up-feature-branches"><span class="toc-section-number">13.8</span> Clean up feature branches</a></li>
<li><a href="code-publication.html#create-github-release" id="toc-create-github-release"><span class="toc-section-number">13.9</span> Create Github release</a></li>
</ul></li>
<li><a href="data-publication.html#data-publication" id="toc-data-publication"><span class="toc-section-number">14</span> Data Publication</a>
<ul>
<li><a href="data-publication.html#overview" id="toc-overview"><span class="toc-section-number">14.1</span> Overview</a></li>
<li><a href="data-publication.html#removing-phi" id="toc-removing-phi"><span class="toc-section-number">14.2</span> Removing PHI</a>
<ul>
<li><a href="data-publication.html#personal-information" id="toc-personal-information"><span class="toc-section-number">14.2.1</span> Personal information</a></li>
<li><a href="data-publication.html#dates" id="toc-dates"><span class="toc-section-number">14.2.2</span> Dates</a></li>
<li><a href="data-publication.html#geographic-information" id="toc-geographic-information"><span class="toc-section-number">14.2.3</span> Geographic information</a></li>
</ul></li>
<li><a href="data-publication.html#create-public-ids" id="toc-create-public-ids"><span class="toc-section-number">14.3</span> Create public IDs</a>
<ul>
<li><a href="data-publication.html#rationale" id="toc-rationale"><span class="toc-section-number">14.3.1</span> Rationale</a></li>
<li><a href="data-publication.html#a-single-set-of-public-ids-for-each-study" id="toc-a-single-set-of-public-ids-for-each-study"><span class="toc-section-number">14.3.2</span> A single set of public IDs for each study</a></li>
<li><a href="data-publication.html#example-scripts" id="toc-example-scripts"><span class="toc-section-number">14.3.3</span> Example scripts</a></li>
</ul></li>
<li><a href="data-publication.html#create-a-data-repository" id="toc-create-a-data-repository"><span class="toc-section-number">14.4</span> Create a data repository</a>
<ul>
<li><a href="data-publication.html#steps-for-creating-an-open-science-framework-osf-repository" id="toc-steps-for-creating-an-open-science-framework-osf-repository"><span class="toc-section-number">14.4.1</span> Steps for creating an Open Science Framework (OSF) repository:</a></li>
</ul></li>
<li><a href="data-publication.html#edit-and-test-analysis-scripts" id="toc-edit-and-test-analysis-scripts"><span class="toc-section-number">14.5</span> Edit and test analysis scripts</a></li>
<li><a href="data-publication.html#create-a-public-github-page-for-public-scripts" id="toc-create-a-public-github-page-for-public-scripts"><span class="toc-section-number">14.6</span> Create a public GitHub page for public scripts</a></li>
<li><a href="data-publication.html#go-live" id="toc-go-live"><span class="toc-section-number">14.7</span> Go live</a></li>
</ul></li>
<li><a href="slurm.html#slurm" id="toc-slurm"><span class="toc-section-number">15</span> Slurm and cluster computing</a>
<ul>
<li><a href="slurm.html#getting-started" id="toc-getting-started"><span class="toc-section-number">15.1</span> Getting started</a>
<ul>
<li><a href="slurm.html#one-time-system-set-up" id="toc-one-time-system-set-up"><span class="toc-section-number">15.1.1</span> One-Time System Set-Up</a></li>
</ul></li>
<li><a href="slurm.html#moving-files-to-sherlock" id="toc-moving-files-to-sherlock"><span class="toc-section-number">15.2</span> Moving files to Sherlock</a></li>
<li><a href="slurm.html#installing-packages-on-sherlock" id="toc-installing-packages-on-sherlock"><span class="toc-section-number">15.3</span> Installing packages on Sherlock</a></li>
<li><a href="slurm.html#testing-your-code" id="toc-testing-your-code"><span class="toc-section-number">15.4</span> Testing your code</a>
<ul>
<li><a href="slurm.html#the-command-line" id="toc-the-command-line"><span class="toc-section-number">15.4.1</span> The command line</a></li>
<li><a href="slurm.html#the-sherlock-ondemand-dashboard" id="toc-the-sherlock-ondemand-dashboard"><span class="toc-section-number">15.4.2</span> The Sherlock OnDemand Dashboard</a></li>
<li><a href="slurm.html#filepaths-configuration-on-sherlock" id="toc-filepaths-configuration-on-sherlock"><span class="toc-section-number">15.4.3</span> Filepaths &amp; configuration on Sherlock</a></li>
</ul></li>
<li><a href="slurm.html#storage-group-storage-access" id="toc-storage-group-storage-access"><span class="toc-section-number">15.5</span> Storage &amp; group storage access</a>
<ul>
<li><a href="slurm.html#individual-storage" id="toc-individual-storage"><span class="toc-section-number">15.5.1</span> Individual storage</a></li>
<li><a href="slurm.html#group-storage" id="toc-group-storage"><span class="toc-section-number">15.5.2</span> Group storage</a></li>
<li><a href="slurm.html#folder-permissions" id="toc-folder-permissions"><span class="toc-section-number">15.5.3</span> Folder permissions</a></li>
</ul></li>
<li><a href="slurm.html#running-big-jobs-1" id="toc-running-big-jobs-1"><span class="toc-section-number">15.6</span> Running big jobs</a></li>
</ul></li>
<li><a href="checklists.html#checklists" id="toc-checklists"><span class="toc-section-number">16</span> Checklists</a>
<ul>
<li><a href="checklists.html#pre-analysis-plan-checklist" id="toc-pre-analysis-plan-checklist"><span class="toc-section-number">16.1</span> Pre-analysis plan checklist</a></li>
<li><a href="checklists.html#code-checklist" id="toc-code-checklist"><span class="toc-section-number">16.2</span> Code checklist</a></li>
<li><a href="checklists.html#manuscript-checklist" id="toc-manuscript-checklist"><span class="toc-section-number">16.3</span> Manuscript checklist</a></li>
<li><a href="checklists.html#figure-checklist" id="toc-figure-checklist"><span class="toc-section-number">16.4</span> Figure checklist</a></li>
</ul></li>
<li><a href="resources.html#resources" id="toc-resources"><span class="toc-section-number">17</span> Resources</a>
<ul>
<li><a href="resources.html#resources-for-r" id="toc-resources-for-r"><span class="toc-section-number">17.1</span> Resources for R</a></li>
<li><a href="resources.html#resources-for-git-github" id="toc-resources-for-git-github"><span class="toc-section-number">17.2</span> Resources for Git &amp; Github</a></li>
<li><a href="resources.html#scientific-figures" id="toc-scientific-figures"><span class="toc-section-number">17.3</span> Scientific figures</a></li>
<li><a href="resources.html#writing" id="toc-writing"><span class="toc-section-number">17.4</span> Writing</a></li>
<li><a href="resources.html#presentations" id="toc-presentations"><span class="toc-section-number">17.5</span> Presentations</a></li>
<li><a href="resources.html#professional-advice" id="toc-professional-advice"><span class="toc-section-number">17.6</span> Professional advice</a></li>
<li><a href="resources.html#funding" id="toc-funding"><span class="toc-section-number">17.7</span> Funding</a></li>
<li><a href="resources.html#ethics-and-global-health-research" id="toc-ethics-and-global-health-research"><span class="toc-section-number">17.8</span> Ethics and global health research</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jadebc/lab-manual" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Benjamin-Chung Lab Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-publication" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Data Publication<a href="data-publication.html#data-publication" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Adapted from Fanice Nyatigo and Ben Arnold’s chapter in the <a href="https://urlisolation.com/browser?clickId=524DE241-3F8F-4C98-B619-3C278374BF64&amp;traceToken=1728923499%3Bucsfmed_hosted%3Bhttps%3A%2F%2Fproctor-ucsf.github.io%2Fd&amp;url=https%3A%2F%2Fproctor-ucsf.github.io%2Fdcc-handbook%2Fpublicdata.html">Proctor-UCSF Lab Manual</a></p>
<div id="overview" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Overview<a href="data-publication.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<blockquote>
<p><em><strong>Warning! </strong> <strong>NEVER</strong> push a dataset into the public domain (e.g., GitHub, OSF) without first checking with Jade to ensure that it is appropriately de-identified and we have approval from the sponsor and/or human subjects review board to do so. For example, we will need to re-code participant IDs (even if they contain no identifying information) before making data public to completely break the link between IDs and identifiable information stored on our servers. </em></p>
</blockquote>
<hr />
<p>If you are releasing data into the public domain, then consider making available <em>at minimum</em> a <code>.csv</code> file and a codebook of the same name (note: you should have a codebook for internal data as well). We often also make available <code>.rds</code> files as well. For example, your <code>mystudy/data/public</code> directory could include three files for a single dataset, two with the actual data in <code>.rds</code> and <code>.csv</code> formats, and a third that describes their contents:</p>
<pre><code>analysis_data_public.csv
analysis_data_public.rds
analysis_data_public_codebook.txt</code></pre>
<p>In general, datasets are usually too big to save on GitHub, but occasionally they are small. Here is an example of where we actually pushed the data directly to GitHub: <a href="https://github.com/ben-arnold/enterics-seroepi/tree/master/data" class="uri">https://github.com/ben-arnold/enterics-seroepi/tree/master/data</a> .</p>
<p>If the data are bigger, then maintaining them under version control in your git repository can be unweildy. Instead, we recommend using another stable repository that has version control, such as the Open Science Framework (<a href="https://osf.io">osf.io</a>). For example, all of the data from the WASH Benefits trials (led by investigators at Berkeley, icddr,b, IPA-Kenya and others) are all stored through data components nested within in OSF projects: <a href="https://osf.io/tprw2/" class="uri">https://osf.io/tprw2/</a>. Another good option is Dryad (<a href="https://datadryad.org/">datadryad.org</a>) or the (Stanford Digital Repository)[<a href="https://sdr.stanford.edu/" class="uri">https://sdr.stanford.edu/</a>].</p>
<p>We recommend cross-linking public files in GitHub (scripts/notebooks only) and OSF/Dryad/Stanford Digital Repository.</p>
<p>Below are the main steps to making data public, after finalizing the analysis datasets and scripts:<br />
1. Remove Protected Health Information (PHI)<br />
2. Create public IDs or join already created public IDs to the data<br />
3. Create an OSF repository and/or Dryad/Stanford Digital Repository<br />
4. Edit analysis scripts to run using the public datasets and test (optional)<br />
5. Create a public github page for analysis scripts and link to OSF and/or Dryad/Zenodo<br />
6. Go live</p>
</div>
<div id="removing-phi" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Removing PHI<a href="data-publication.html#removing-phi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once the data is finalized for analysis, the first step is to strip it of Protected Health Information (PHI), or any other data that could be used to link back to specific participants, such as names, birth dates, or GPS coordinates at the village/neighborhood level or below. PHI includes, but is not limited to:</p>
<div id="personal-information" class="section level3 hasAnchor" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Personal information<a href="data-publication.html#personal-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are identifiers that directly point to specific individuals, such as:<br />
- Names, addresses, photographs, date of birth<br />
- A combination of age, sex, and geographic location (below population 20,000) is considered identifiable</p>
</div>
<div id="dates" class="section level3 hasAnchor" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Dates<a href="data-publication.html#dates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Any specific dates (e.g., study visit dates, birth dates, treatment dates) are usually problematic.<br />
- If a dataset requires high resolution temporal information, coarsen visit or measurement dates to be two variables: year and week of the year (1-52).<br />
- If a dataset requires age, provide that information without a birth date (typically month resolution is sufficient)</p>
<hr />
<blockquote>
<p><em><strong>Caution!</strong> If making changes to the format of dates or ages, make sure your analysis code runs on these modified versions of the data (step 3)! </em></p>
</blockquote>
<hr />
</div>
<div id="geographic-information" class="section level3 hasAnchor" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> Geographic information<a href="data-publication.html#geographic-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Do not include GPS coordinates (longitude, latitude) except in special circumstances where they have been obfuscated/shifted. Reach out to Jade before doing this because it can be complicated.</p>
<p>Do not include place names or codes (e.g., US Zip Codes) if the place contains &lt;20,000 people. For villages or neighborhoods, code them with uninformative IDs. For sub-districts or districts, names are fine.</p>
<p>If an analysis requires GPS locations (e.g., to make a map), then typically we include a disclaimer in the article’s data availability statement that explains we cannot make GPS locations public to protect participant confidentiality. As a middle ground, we typically make our <em>code</em> public that runs on the geo-located data for transparency, even if independent researchers can’t actually run that code (although please be careful to ensure the code itself does not in any way include geographic identifiers).</p>
<p>For more examples of what constitutes PHI, please refer to this link: <a href="https://cphs.berkeley.edu/hipaa/hipaa18.html" class="uri">https://cphs.berkeley.edu/hipaa/hipaa18.html</a></p>
</div>
</div>
<div id="create-public-ids" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Create public IDs<a href="data-publication.html#create-public-ids" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="rationale" class="section level3 hasAnchor" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Rationale<a href="data-publication.html#rationale" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Stanford IRB requires that public datasets not include the original study IDs to identify participants or other units in the study (such as village IDs). The reason is that those IDs are linked in our private datasets to PHI. By creating a new set of public IDs, the public dataset is one step further removed from the potential to link to PHI.</p>
</div>
<div id="a-single-set-of-public-ids-for-each-study" class="section level3 hasAnchor" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> A single set of public IDs for each study<a href="data-publication.html#a-single-set-of-public-ids-for-each-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For each study, it is ideal to create a single set of public IDs whenever possible. We could create a new set of public IDs for every public dataset, but the downside is that independent researchers could no longer link data that might be related. By creating a single set of public IDs associated with each internal study ID, public files retain the link.</p>
<p>Maintaining a single set of public IDs requires a shared “bridge” dataset, that includes a row for each study ID and has the associated public ID. For studies with multiple levels of ID, we would typically have separate bridge datasets for each type of ID (e.g,. cluster ID, participant ID, etc.)</p>
<p>Create a public ID that can be used to uniquely identify participants and that can internally be linked to the original study IDs. We recommend creating a subdirectory in the study’s shared data directory to store the public IDs. The shared location enables multiple projects to use the same IDs. Create the IDs using a script that reads in the study IDs, creates a unique (uninformative) public ID for the study IDs, and then saves the bridge dataset. The script should be saved in the same directory as the public ID files.</p>
<hr />
<blockquote>
<p><em><strong>Caution!</strong> Note that small differences may arise if the new public IDs do not necessarily order participants in the same way as the internal IDs. The small differences are all in estimates that rely on resampling, such as Bootstrap CIs, permutation P-values, and TMLE, as the resampling process may lead tp slightly different re-samples. The key here, to ensure the results are consistent irrespective of the dataset used, is simply to not assign public IDs randomly. Use <code>rank()</code> on the internal ID instead of <code>row_number()</code> to ensure that the order is always the same. </em></p>
</blockquote>
<hr />
</div>
<div id="example-scripts" class="section level3 hasAnchor" number="14.3.3">
<h3><span class="header-section-number">14.3.3</span> Example scripts<a href="data-publication.html#example-scripts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have created a self-contained and reproducible example that you can run and replicate when making data public for your projects. It contains the following files and folders:</p>
<ol style="list-style-type: decimal">
<li><code>data/final/</code>- folder containing the projects final data in both csv and rds formats<br />
</li>
<li><code>code/DEMO_generate_public_IDs.R</code>- creates randomly generated public IDs that can be matched to the trial’s assigned patient IDs.<br />
</li>
<li><code>data/make_public/DEMO_internal_to_publicID.csv</code>- the output from step #2, a bridge dataset with two variables- the new public ID and the patient’s assigned ID.<br />
</li>
<li><code>code/DEMO_create_public_datasets.R</code>- joins the public IDs to the trial’s full dataset, and strips it of the assigned patient ID.</li>
<li><code>data/public/</code>- folder containing the output from step #3- de-identified public dataset, in csv and rds formats, with uniquely identifying public IDs that cannot be easily linked back to the patient’s ID.</li>
</ol>
<p>The example workflow is accessible via GitHub: <a href="https://github.com/proctor-ucsf/dcc-handbook/tree/master/templates/making-data-public" class="uri">https://github.com/proctor-ucsf/dcc-handbook/tree/master/templates/making-data-public</a></p>
</div>
</div>
<div id="create-a-data-repository" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Create a data repository<a href="data-publication.html#create-a-data-repository" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, ensure that you create a codebook and metadata file for each public dataset <a href="https://proctor-ucsf.github.io/dcc-handbook/datawrangling.html#documenting-datasets">See the DCC guide on Documenting datasets</a>. Use the same name as the datasets, but with “-codebook.txt” / “-codebook.html” / “-codebook.csv” at the end (depending on the file format for the codebook). One nice option is the R codebook package, which also generates JSON output that is machine-readable.</p>
<div id="steps-for-creating-an-open-science-framework-osf-repository" class="section level3 hasAnchor" number="14.4.1">
<h3><span class="header-section-number">14.4.1</span> Steps for creating an Open Science Framework (OSF) repository:<a href="data-publication.html#steps-for-creating-an-open-science-framework-osf-repository" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Create a new OSF project per these instructions: <a href="https://help.osf.io/article/252-create-a-project" class="uri">https://help.osf.io/article/252-create-a-project</a></li>
<li>Create a data component and upload the datasets in .csv and .rds format along with the codebooks. The primary format for public dissemination is .csv but we make the .rds files available too as auxiliary files for convenience.</li>
<li>Create a notebook component and upload the final .html files (which will not be on github… but see optional item below)</li>
<li>On the OSF landing Wiki, provide some context. Here is a recent example: <a href="https://osf.io/954bt/" class="uri">https://osf.io/954bt/</a></li>
<li>Create a Digital Object Identifier (DOI) for the repository. A DOI is a unique identifier that provides a persistent link to content, such as a dataset in this case. <a href="https://researchdata.princeton.edu/research-lifecycle-guide/whats-doi-and-what-should-i-know-about-citing-datasets">Learn more about DOIs</a></li>
<li>Optional: Complete the software checklist and system requirement guide for the analysis to guide others. Include it on the GitHub README for the project: <a href="https://github.com/proctor-ucsf/mordor-antibody" class="uri">https://github.com/proctor-ucsf/mordor-antibody</a></li>
</ol>
</div>
</div>
<div id="edit-and-test-analysis-scripts" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> Edit and test analysis scripts<a href="data-publication.html#edit-and-test-analysis-scripts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Make minor changes to the analysis scripts so that they run on public data. If using version control in GitHub, the most straight-forward way is to create a branch from the main git branch that reads in the public files, and then renames the new public ID variable, e.g., “id_public” to the internally recognized ID variable name, e.g. “recordID”, when reading in the public data. Re-run all the analysis scripts to ensure that they still work with the public version of the dataset.</p>
</div>
<div id="create-a-public-github-page-for-public-scripts" class="section level2 hasAnchor" number="14.6">
<h2><span class="header-section-number">14.6</span> Create a public GitHub page for public scripts<a href="data-publication.html#create-a-public-github-page-for-public-scripts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At minimum, we should include all of the scripts required to run the analyses. <strong>IMPORTANT</strong>: ensure you have taken a snapshot and saved your computing environment using the <code>renv</code> package (<a href="#renv"><code>renv</code></a>).</p>
<p>See examples:<br />
- ACTION - <a href="https://github.com/proctor-ucsf/ACTION-public" class="uri">https://github.com/proctor-ucsf/ACTION-public</a><br />
- NAITRE - <a href="https://github.com/proctor-ucsf/NAITRE-primary" class="uri">https://github.com/proctor-ucsf/NAITRE-primary</a></p>
<hr />
<blockquote>
<p><em><strong>Caution!</strong> Read through the scripts carefully to ensure there is no PHI in the code itself </em></p>
</blockquote>
<hr />
<p>Once a public GitHub page exists, you can create a new component on an OSF project (step 3, above) and link it to the public version of the GitHub repo.</p>
</div>
<div id="go-live" class="section level2 hasAnchor" number="14.7">
<h2><span class="header-section-number">14.7</span> Go live<a href="data-publication.html#go-live" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On GitHub, it is useful to create an official “release” version to freeze the repository, where you can have “associated files” with each version. Include the .html notebook output as additional files — since they aren’t tracked in GitHub, it does provide a way of freezing / saving the HTML output for us and others. OSF examples of a studies from UCSF’s Proctor Foundation:<br />
- ACTION - <a href="https://osf.io/ca3pe/" class="uri">https://osf.io/ca3pe/</a><br />
- NAITRE - <a href="https://osf.io/ujeyb/" class="uri">https://osf.io/ujeyb/</a><br />
- MORDOR Niger antibody study - <a href="https://osf.io/dgsq3/" class="uri">https://osf.io/dgsq3/</a></p>
<p>Further reading on end-to-end data management: <a href="https://plos.org/resource/how-to-store-and-manage-your-data/#data-management-plan">How to Store and Manage Your Data - PLOS</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="code-publication.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="slurm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jadebc/lab-manual/edit/master/13-data-publication.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["lab-manual.pdf", "lab-manual.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
